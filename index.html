<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DHL eCommerce Value Chain</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f4f4f4; overflow: hidden; }
        #chart { display: flex; justify-content: center; align-items: center; height: 100vh; }
        #details {
            position: absolute; top: 20px; right: 20px; width: 300px;
            background: white; padding: 20px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: none; border-left: 5px solid #d40511;
        }
        h2 { margin-top: 0; font-size: 18px; color: #d40511; }
        p { font-size: 14px; color: #333; line-height: 1.5; }
        .instruction { position: absolute; top: 20px; left: 20px; font-size: 14px; color: #666; }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>

<div class="instruction">Click center to zoom out. Click arcs to zoom in.</div>

<div id="details">
    <h2 id="node-name">Process Name</h2>
    <p id="node-desc">Description goes here...</p>
</div>

<div id="chart"></div>

<script>
    // ==========================================
    // 1. DATA SECTION
    // Paste the content of data.json inside the variable below.
    // It should look like: const rawData = { "name": "...", "children": [...] };
    // ==========================================
    
    const rawData = null; // <--- DELETE 'null' AND PASTE YOUR JSON HERE

    // ==========================================
    // 2. VISUALIZATION CODE
    // ==========================================
    
    if (!rawData) {
        alert("Please paste the JSON content into the 'rawData' variable in the HTML code.");
    } else {
        renderChart(rawData);
    }

    function renderChart(data) {
        const width = window.innerWidth;
        const height = window.innerHeight;
        const radius = Math.min(width, height) / 2.5; 
        const color = d3.scaleOrdinal(d3.schemeTableau10);

        const svg = d3.select("#chart").append("svg")
            .attr("viewBox", [-width / 2, -height / 2, width, height]);

        const hierarchy = d3.hierarchy(data)
            .sum(d => d.children ? 0 : 1)
            .sort((a, b) => b.value - a.value);

        const root = d3.partition()
            .size([2 * Math.PI, hierarchy.height + 1])
            (hierarchy);

        root.each(d => d.current = d);

        const arc = d3.arc()
            .startAngle(d => d.x0)
            .endAngle(d => d.x1)
            .padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.005))
            .padRadius(radius * 1.5)
            .innerRadius(d => d.y0 * radius)
            .outerRadius(d => Math.max(d.y0 * radius, d.y1 * radius - 1));

        const path = svg.append("g")
            .selectAll("path")
            .data(root.descendants().slice(1))
            .join("path")
            .attr("fill", d => { while (d.depth > 1) d = d.parent; return color(d.data.name); })
            .attr("fill-opacity", d => arcVisible(d.current) ? (d.children ? 0.8 : 0.6) : 0)
            .attr("d", d => arc(d.current))
            .style("cursor", "pointer");

        path.filter(d => d.children)
            .style("cursor", "pointer")
            .on("click", clicked);

        // Hover Effect
        path.on("mouseover", function(event, d) {
            d3.select("#details").style("display", "block");
            let cleanName = d.data.name.includes(":") ? d.data.name.split(":")[1] : d.data.name;
            let id = d.data.name.includes(":") ? d.data.name.split(":")[0] : "";
            
            d3.select("#node-name").text(id + " " + cleanName);
            d3.select("#node-desc").text(d.data.description || "No description provided.");
            
            d3.select(this).attr("fill-opacity", 1);
        }).on("mouseout", function(event, d) {
            d3.select(this).attr("fill-opacity", d => arcVisible(d.current) ? (d.children ? 0.8 : 0.6) : 0);
        });

        // Center Circle (Back Button)
        const parent = svg.append("circle")
            .datum(root)
            .attr("r", radius)
            .attr("fill", "none")
            .attr("pointer-events", "all")
            .on("click", clicked
